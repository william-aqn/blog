---
layout: post
title: "Подписываем ЭЦП word/excel/pdf документ"
description: "Через криптопровайдера Vipnet CSP без установки КриптоПРО и без физического токена. За 1 день."
tags: эцп
---
# Подписываем ЭЦП word/excel/pdf документ через криптопровайдера Vipnet CSP без установки КриптоПРО и без физического токена. За 1 день.
Disclaimer: Нельзя просто так взять и подписать документ, техподдержка говорит дичь (т.е. ничего полезного)

1. Делаем виртуальную машину на основе **ОРИГИНАЛЬНОЙ** (не репака) **Windows 10** (версия **1607**, сборка **14393**)
https://nnmclub.to/forum/viewtopic.php?t=1042256
magnet:?xt=urn:btih:33897D649002A253918465C0B07009F99D961C15

2. Устанавливаем Microsoft Office **максимальную версию 2013**
https://nnmclub.to/forum/viewtopic.php?t=1551670
magnet:?xt=urn:btih:93dd4132850b9280a20758616a6a3e41e81251c6
*Иначе получите ошибку*
```
Аалгоритм шифрования необходимый для выполнения этой операции не установлен на этом компьютере
```
~~Тех.поддержка говорит нужен КриптоПро Office Signature 2.0, который в свою очередь требует КриптоПРО CSP, который стоит денег, который конфликтует с бесплатной Vipnet CSP. Итого - нафиг.~~

3. **Делаем снапшот виртуалки**. Это важно!

4. Устанавливаем ViPNet CSP Win 4.4.2.2388 от 30.07.2021 с **отключенной галкой TLS** (иначе чёрный экран получите после перезагрузки)
https://infotecs.ru/product/vipnet-csp.html

5. Перезагружаем виртуалку. Если что то пошло не так - откатываемся, и отключаем забытую галку TLS при установке ViPNet CSP.

6. Покупаем ЭЦП для физ лиц, например тут всего за 900 рублей на 15 месяцев, при покупке **обязательно выбираем VipnetCSP**
https://astral.ru/tarify/astral-et/astral-et-fl/23803/

7. В течении одного дня проходим различные бюрократические процедуры, 

8. **Делаем бэкап криптоконтейнера**. А лучше в несколько разных мест.

9. Делаем снапшот виртуалки, что бы откатываться для сброса Adobe и КриптоПро PDF.

10. Устанавливаем Adobe DC Pro **исключительно версию x86**
https://nnmclub.to/forum/viewtopic.php?t=1557398
magnet:?xt=urn:btih:7FC889FDBB22EB6D2A3823F1385F85A4BE075156

10.1. Adobe Reader DC **исключительно версию x86**
Выбираем windows 10, Russian, Reader DC 2019.008.20071 Russian for Windows 
Снимаем галки с McAfee
Жмём скачать
https://get.adobe.com/ru/reader/otherversions/


11. Устанавливаем плагин КриптоПро PDF для подписывания pdf, который работает ограниченное время.
https://www.cryptopro.ru/products/other/pdf/downloads

12. В настройках Adobe DC заходим Редактирование->Установки->Подписи->Создание и оформление->**Метод подписания** по умолчанию = "КриптоПро PDF" + **Формат подписания** по умолчанию = "Эквивалент CaDES"
*Иначе получим вот такую ошибку:*
```
Не удалось закончить создание этой подписи.  
Ошибка превышения размера.  
Неподдерживаемый алгоритм открытых ключей
```

13. Подписываем документы, наслаждаемся. Откатываемся через 90 дней на снапшот, и ставим снова КриптоПро PDF.